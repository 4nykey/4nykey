--- a/xpcom/io/TorFileUtils.cpp
+++ b/xpcom/io/TorFileUtils.cpp
@@ -82,7 +82,7 @@ nsresult TorBrowser_GetUserDataDir(nsIFi
   }
 #  endif
 
-#elif defined(ANDROID)
+#elif defined(ANDROID) || defined(TOR_BROWSER_DATA_IN_HOME_DIR)
   // Tor Browser Android stores data in the app home directory.
   const char* homeDir = getenv("HOME");
   if (!homeDir || !*homeDir) return NS_ERROR_FAILURE;
--- a/toolkit/xre/nsXREDirProvider.cpp
+++ b/toolkit/xre/nsXREDirProvider.cpp
@@ -1419,6 +1419,9 @@ nsresult nsXREDirProvider::GetUserDataDi
 #if !defined(ANDROID)
 #  ifdef TOR_BROWSER_DATA_OUTSIDE_APP_DIR
   rv = localDir->AppendNative("Browser"_ns);
+#elif defined(TOR_BROWSER_DATA_IN_HOME_DIR)
+  rv = localDir->AppendRelativeNativePath(MOZ_USER_DIR
+                                        XPCOM_FILE_PATH_SEPARATOR "torbrowser"_ns);
 #  else
   rv = localDir->AppendRelativeNativePath("Data" XPCOM_FILE_PATH_SEPARATOR
                                           "Browser"_ns);
@@ -1427,7 +1430,20 @@ nsresult nsXREDirProvider::GetUserDataDi
 #endif
 
   if (aLocal) {
+#ifndef TOR_BROWSER_DATA_IN_HOME_DIR
     rv = localDir->AppendNative("Caches"_ns);
+#else
+    const char* cacheHome = getenv("XDG_CACHE_HOME");
+    if (cacheHome && *cacheHome) {
+      rv = NS_NewNativeLocalFile(nsDependentCString(cacheHome), true,
+                                 getter_AddRefs(localDir));
+    } else {
+      rv = NS_NewNativeLocalFile(nsDependentCString(PR_GetEnv("HOME")), true,
+                                 getter_AddRefs(localDir));
+      rv = localDir->AppendRelativeNativePath(".cache"_ns);
+    }
+    rv = localDir->AppendRelativeNativePath("torbrowser"_ns);
+#endif
     NS_ENSURE_SUCCESS(rv, rv);
   }
 
@@ -1460,7 +1476,11 @@ nsresult nsXREDirProvider::GetSysUserExt
 
 nsresult nsXREDirProvider::GetSysUserExtensionsDevDirectory(nsIFile** aFile) {
   nsCOMPtr<nsIFile> localDir;
+#ifndef TOR_BROWSER_DATA_IN_HOME_DIR
   nsresult rv = GetUserDataDirectoryHome(getter_AddRefs(localDir), false);
+#else
+  nsresult rv = GetTorBrowserUserDataDir(getter_AddRefs(localDir));
+#endif
   NS_ENSURE_SUCCESS(rv, rv);
 
   rv = AppendSysUserExtensionsDevPath(localDir);
